CREATE TABLE StateLookup(
    StateID INT PRIMARY KEY      NOT NULL,
    State   CHAR(2)         NOT NULL
);
INSERT INTO StateLookup
(StateID, State)
Values
(1, 'AL');
INSERT INTO StateLookup
(StateID, State)
Values
(2, 'AK');
INSERT INTO StateLookup
(StateID, State)
Values
(3, 'AZ');
INSERT INTO StateLookup
(StateID, State)
Values
(4, 'AR');
INSERT INTO StateLookup
(StateID, State)
Values
(5, 'CA');
INSERT INTO StateLookup
(StateID, State)
Values
(6, 'CO');
INSERT INTO StateLookup
(StateID, State)
Values
(7, 'CT');
INSERT INTO StateLookup
(StateID, State)
Values
(8, 'DE');
INSERT INTO StateLookup
(StateID, State)
Values
(9, 'FL');
INSERT INTO StateLookup
(StateID, State)
Values
(10, 'GA');
INSERT INTO StateLookup
(StateID, State)
Values
(11, 'HI');
INSERT INTO StateLookup
(StateID, State)
Values
(12, 'ID');
INSERT INTO StateLookup
(StateID, State)
Values
(13, 'IL');
INSERT INTO StateLookup
(StateID, State)
Values
(14, 'IN');
INSERT INTO StateLookup
(StateID, State)
Values
(15, 'IA');
INSERT INTO StateLookup
(StateID, State)
Values
(16, 'KS');
INSERT INTO StateLookup
(StateID, State)
Values
(17, 'KY');
INSERT INTO StateLookup
(StateID, State)
Values
(18, 'LA');
INSERT INTO StateLookup
(StateID, State)
Values
(19, 'ME');
INSERT INTO StateLookup
(StateID, State)
Values
(20, 'MD');
INSERT INTO StateLookup
(StateID, State)
Values
(21, 'MA');
INSERT INTO StateLookup
(StateID, State)
Values
(22, 'MI');
INSERT INTO StateLookup
(StateID, State)
Values
(23, 'MN');
INSERT INTO StateLookup
(StateID, State)
Values
(24, 'MS');
INSERT INTO StateLookup
(StateID, State)
Values
(25, 'MO');
INSERT INTO StateLookup
(StateID, State)
Values
(26, 'MT');
INSERT INTO StateLookup
(StateID, State)
Values
(27, 'NE');
INSERT INTO StateLookup
(StateID, State)
Values
(28, 'NV');
INSERT INTO StateLookup
(StateID, State)
Values
(29, 'NH');
INSERT INTO StateLookup
(StateID, State)
Values
(30, 'NJ');
INSERT INTO StateLookup
(StateID, State)
Values
(31, 'NM');
INSERT INTO StateLookup
(StateID, State)
Values
(32, 'NY');
INSERT INTO StateLookup
(StateID, State)
Values
(33, 'NC');
INSERT INTO StateLookup
(StateID, State)
Values
(34, 'ND');
INSERT INTO StateLookup
(StateID, State)
Values
(35, 'OH');
INSERT INTO StateLookup
(StateID, State)
Values
(36, 'OK');
INSERT INTO StateLookup
(StateID, State)
Values
(37, 'OR');
INSERT INTO StateLookup
(StateID, State)
Values
(38, 'PA');
INSERT INTO StateLookup
(StateID, State)
Values
(39, 'RI');
INSERT INTO StateLookup
(StateID, State)
Values
(40, 'SC');
INSERT INTO StateLookup
(StateID, State)
Values
(41, 'SD');
INSERT INTO StateLookup
(StateID, State)
Values
(42, 'TN');
INSERT INTO StateLookup
(StateID, State)
Values
(43, 'TX');
INSERT INTO StateLookup
(StateID, State)
Values
(44, 'UT');
INSERT INTO StateLookup
(StateID, State)
Values
(45, 'VT');
INSERT INTO StateLookup
(StateID, State)
Values
(46, 'VA');
INSERT INTO StateLookup
(StateID, State)
Values
(47, 'WA');
INSERT INTO StateLookup
(StateID, State)
Values
(48, 'WV');
INSERT INTO StateLookup
(StateID, State)
Values
(49, 'WI');
INSERT INTO StateLookup
(StateID, State)
Values
(50, 'WY');

CREATE TABLE Supplier (
    SupplierID INT  GENERATED BY DEFAULT AS IDENTITY,
    SupplierName        Varchar2(255) NOT NULL,
    ContactFirstName    Varchar2(255) NOT NULL,
    ContactLastName     Varchar2(255) NOT NULL,
    StateID             INT      NOT NULL,
    City                Varchar2(255) NOT NULL,
    StreetAddress                Varchar2(255) NOT NULL,
    Zip             INT NOT NULL,
    PRIMARY KEY(SupplierID), 
    FOREIGN KEY(StateID) REFERENCES StateLookup(StateID)
);
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(1, 'Better Bulk', 'Thomas', 'Whitehead', 4, 'Conway', '4981 Dawson Drive', 72032 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(2, 'Happy Wholesale', 'William', 'Byrd', 5, 'Red Bluff', '4306  Hill Croft Farm Road', 96080 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(3, 'Wholesale Queen', 'David', 'Nichols', 11, 'Waialua', '3989  Indiana Avenue', 96791 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(4, 'Wholesale Heaven', 'Cindy', 'Goldstein', 18, 'Monroe', '1578  Norma Lane', 71201 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(5, 'Whale Wholesale', 'Pat', 'Hill', 31, 'Las Cruces', '3216  Bird Street', 88005 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(6, 'Bulk Bros', 'Brian', 'Otten', 32, 'Elmsford', '3748  Morningview Lane', 10523 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(7, 'Total Suppliers', 'Kathy', 'McLellan', 33, 'Gastonia', '2827  Harry Place', 28052 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(8, 'Global Supply', 'Moises', 'Lane', 9, 'Melbourne', '2739  Rosemont Avenue', 32935 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(9, 'Wholesale Zone', 'Laura', 'Dalley', 43, 'Amarillo', '2087  Smithfield Avenue', 79101 );
INSERT INTO Supplier
(SupplierID, SupplierName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(10, 'BigBox Supply', 'Francine', 'Arnold', 38, 'Pittsburgh', '473  Platinum Drive', 15212 );

CREATE TABLE Store (
    StoreID INT  GENERATED BY DEFAULT AS IDENTITY,
    StoreName        Varchar2(255)      NOT NULL,
    ContactFirstName    Varchar2(255)   NOT NULL,
    ContactLastName     Varchar2(255)   NOT NULL,
    StateID             INT             NOT NULL,
    City                Varchar2(255)   NOT NULL,
    StreetAddress       Varchar2(255)   NOT NULL,
    Zip             INT NOT NULL,
    PRIMARY KEY(StoreID), 
    FOREIGN KEY(StateID) REFERENCES StateLookup(StateID)
);
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(1, 'Bachman Beauty', 'Aimee', 'Bachman', 4, 'Conway', '3100  Mulberry Avenue', 72032 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(2, 'Eco Focus', 'Jack', 'Tapia', 5, 'Calabasas', '3316  Quiet Valley Lane', 91302 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(3, 'Strat Security', 'Amanda', 'Hynes', 11, 'Kokohead', '3240  Arron Smith Drive', 96825 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(4, 'Snazzy Bootz', 'Andre', 'Duarte', 18, 'Metairie', '4078  Woodland Avenue', 70001 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(5, 'WildWest', 'Betty', 'Scroggins', 31, 'Espanola', '2560  Westfall Avenue', 87532 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(6, 'Forest Shop', 'Charles', 'Fernandez', 32, 'Rochester', '845  Caldwell Road', 14620 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(7, 'Crazy Chicken', 'Timothy', 'Scroggins', 33, 'Raleigh', '186  Johnson Street', 27601 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(8, 'Better Leather', 'Karen', 'Spruill', 9, 'Miami', '4986  Marigold Lane', 33169 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(9, 'Graphic Master', 'James', 'Penny', 43, 'Midland', '863  Scenicview Drive', 79701 );
INSERT INTO Store
(StoreID, StoreName, ContactFirstName, ContactLastName, StateID, City, StreetAddress, Zip)
Values
(10, 'Early Bird', 'Daniel', 'Ramirez', 38, 'Pittsburgh', '2980  Jacobs Street', 15226 );

CREATE TABLE Warehouse (
    WarehouseID INT  GENERATED BY DEFAULT AS IDENTITY,
    StateID             INT      NOT NULL,
    City                Varchar2(255) NOT NULL,
    StreetAddress                Varchar2(255) NOT NULL,
    Zip             INT NOT NULL,
    PRIMARY KEY(WarehouseID), 
    FOREIGN KEY(StateID) REFERENCES StateLookup(StateID)
);
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(1, 4, 'Conway', '191  Dawson Drive', 72032 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(2, 5, 'Santa Clara', '1543  Black Oak Hollow Road', 95054 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(3, 11, 'Honolulu', '3192  Stratford Drive', 96819 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(4, 18, 'Lafayette', '2275  Bridge Avenue', 70501 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(5, 31, 'Albuquerque', '5009  Byrd Lane', 87102 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(6, 32, 'New York', '296  Godfrey Road', 10018 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(7, 33, 'Charlotte', '2991  Harry Place', 28202 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(8, 9, 'Ocala', '1498  Long Street', 34474 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(9, 43, 'Houston', '3581  Monroe Street', 77002 );
INSERT INTO Warehouse
(WarehouseID, StateID, City, StreetAddress, Zip)
Values
(10, 38, 'Philadelphia', '163  Valley Drive', 19108 );

CREATE TABLE Product (
    ProductID INT  GENERATED BY DEFAULT AS IDENTITY,
    SupplierID        INT      NOT NULL,
    ProductName     Varchar2(255)   NOT NULL,
    ProductType     Varchar2(255)   NOT NULL,
    ProductPrice    NUMBER(9,2)     NOT NULL,
    ProductDesc     Varchar2(255)   NOT NULL,
    PRIMARY KEY(ProductID), 
    FOREIGN KEY(SupplierID) REFERENCES Supplier(SupplierID)
);
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(1, '1', 'world''s best brush', 'hair care', 4.99, 'hair brush');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(2, '2', 'eco straw', 'utensil', 1.99, 'reusable straw');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(3, '3', 'supershokr', 'self-defense', 29.99, 'stun gun');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(4, '4', 'raw Leather', 'manufacturing', 34.99, 'boot leather square foot');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(5, '5', 'nine-gallon Hat', 'headgear', 144.99, 'cowboy hat');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(6, '6', 'tree-splitter 9000', 'tool', 124.99, 'wood axe');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(7, '7', 'crazy sauce', 'non-perishable food item', 8.99, 'barbecue sauce gallon');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(8, '8', 'artisan rawhide', 'manufacturing', 14.99, 'rawhide square foot');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(9, '9', 'premium hdmi cable', 'electronics cable', 7.99, 'hdmi cable');
INSERT INTO Product
(ProductID, SupplierID, ProductName, ProductType, ProductPrice, ProductDesc)
Values
(10, '10', 'wake master', 'home electronic', 13.99, 'alarm clock');

CREATE TABLE Inventory (
    InventoryID     INT  GENERATED BY DEFAULT AS IDENTITY,
    WarehouseID             INT      NOT NULL,
    ProductID                INT    NOT NULL,
    Quantity                INT NOT NULL,
    PRIMARY KEY(InventoryID), 
    FOREIGN KEY(WarehouseID) REFERENCES Warehouse(WarehouseID),
    FOREIGN KEY(ProductID) REFERENCES Product(ProductID)
);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(1, 1, 1, 500);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(2, 2, 2, 1200);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(3, 3, 3, 250);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(4, 4, 4, 200);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(5, 5, 5, 300);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(6, 6, 6, 50);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(7, 7, 7, 100);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(8, 8, 8, 400);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(9, 9, 9, 2000);
INSERT INTO Inventory
(InventoryID, WarehouseID, ProductID, Quantity)
Values
(10, 10, 10, 600);

CREATE TABLE Shipment (
    ShipmentID     INT  GENERATED BY DEFAULT AS IDENTITY,
    StoreID             INT      NOT NULL,
    InventoryID         INT    NOT NULL,
    ShipmentDate           DATE NOT NULL,
    ShipmentPrice       NUMBER(9,2) NOT NULL,
    PRIMARY KEY(ShipmentID), 
    FOREIGN KEY(StoreID) REFERENCES Store(StoreID),
    FOREIGN KEY(InventoryID) REFERENCES Inventory(InventoryID)
);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(1, 1, 1, '25-AUG-2020',  2495.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(2, 2, 2, '26-AUG-2020',  2388.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(3, 3, 3, '27-AUG-2020',  7497.50);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(4, 4, 4, '2-NOV-2020',  6998.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(5, 5, 5, '7-NOV-2020',  43497.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(6, 6, 6, '12-NOV-2020',  6249.50);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(7, 7, 7, '14-NOV-2020',  899.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(8, 8, 8, '15-NOV-2020',  5996.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(9, 9, 9, '20-NOV-2020',  15980.00);
INSERT INTO Shipment
(ShipmentID, StoreID, InventoryID, ShipmentDate, ShipmentPrice)
Values
(10, 10, 10, '25-NOV-2020',  8394.00);

CREATE OR REPLACE FUNCTION Tax(col_one IN NUMBER)
  RETURN NUMBER
    IS a NUMBER;
    BEGIN
        SELECT col_one*1.09 INTO a 
        FROM DUAL;
        RETURN a;
    END;
 /
    CREATE OR REPLACE VIEW ShipmentInfo AS 
    SELECT 
        s.ShipmentID, 
        s.InventoryID,
        p.productname AS "Product",
        st.StoreName AS "Destination Store", 
        s.ShipmentDate,
        TO_CHAR( ShipmentPrice, '$999,999,999,999.00') AS "PreTax Total",
        TO_CHAR( TAX(ShipmentPrice), '$999,999,999,999.00') AS "Shipment Total"
    FROM Shipment s
        JOIN store st ON st.StoreID = s.StoreID
        JOIN inventory i ON i.InventoryID = s.InventoryID
        JOIN product p ON p.ProductID = i.ProductID
        ;

    CREATE OR REPLACE VIEW AllInventory AS 
    SELECT 
        i.warehouseid,
        sl.State,
        w.city,
        w.StreetAddress,
        w.zip,
        i.inventoryID, 
        p.productname AS "Product", 
        i.quantity
    FROM inventory i
    JOIN product p ON p.productid = i.productid
    JOIN warehouse w ON w.warehouseid = i.warehouseid
    JOIN StateLookup sl ON sl.StateID = w.stateID
    ;


SELECT * FROM AllInventory;
SELECT * FROM ShipmentInfo;
SELECT * FROM Shipment;
SELECT * FROM Inventory;
SELECT * FROM Product;
SELECT * FROM Warehouse;
SELECT * FROM Store;
SELECT * FROM statelookup;
SELECT * FROM SUPPLIER;
DROP TABLE Product;
DROP TABLE Warehouse;
DROP TABLE Store;
DROP TABLE Shipment;
DROP TABLE SUPPLIER;
DROP TABLE StateLookup;
